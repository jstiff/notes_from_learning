### P2P

- generally composed of 4 things:

  1. each 'node' on the network is identified by a **public key**.
  2. A 'peer discovery system'. how to join a network.
  3. 'Publish-subscribe' system...how we broadcast events over the network.
  4. A distibuted 'Hash table' (DHT) to store data.

- The identity of a node on a network is its public key. It's format is the hash of a small data structure containing one of the fallowing...???

  - RSA public key (Rivest–Shamir–Adleman)
    - RSA is a relatively slow algorithm. Because of this, it is not commonly used to directly encrypt user data. More often, RSA is used to transmit shared keys for symmetric key cryptography, which are then used for bulk encryption-decryption.
  - **ed25519 public key**
    - Edwards-curve Digital Signature Algorithm (EdDSA)
    - Ed25519 is the EdDSA signature scheme using SHA-512 (SHA-2) and Curve25519.
  - **secp256k1 public key**
    - The elliptic curve C is the secp256k1 curve.
    - Public keys are 64 bytes (uncompressed form) or 32 bytes (compressed form) long plus a 1-byte prefix
  - or any asymmetric encryption system.

- Peer Discovery

  - First machines need to "discover" other machines on the network.
    - discover nodes on a local network through **mDNS** and **DNS-SD**.
    - need **bootstraped nodes** if you try to broadcast through the internet. It's too large to try and 'discover' a network. By hardcodeing an IP address....it's a hack and is not ideal...???
      - Bootsrtap node(rendezvous host)..

- Once Connected...

  - you can "broadcast out messages" to the entire network.
    - chat messaging. Messages broadcast to entire network.
    - Blockchain transactions are broadcast out to network.
    - Sending information about topology of the network to improve connectivity.

- Distrubuted Hash Table.
- IPFS:

  - The InterPlanetary File System is a protocol and peer-to-peer network for storing and sharing data in a distributed file system. IPFS uses content-addressing to uniquely identify each file in a global namespace connecting all computing devices
  - Most popular algorithm: **Kademila**
    - Like Rust HashMap, just a key:value store...except each node only stores a partial view of the hashTable...with
      - up to 20 values whose hash is 1 bit away from their PeerId.
      - up to 20 values whose hash is 2 bit away from their PeerId.
      - up to 20 values whose hash is 3 bit away from their PeerId.
        .
        .
        .
      - up to 20 values whose hash is 256 bits away from their PeerId.
    - Unfortunately, this is suseptable to malicious attacks....research is being done at the moment...
  - Storing and retrieving a value is done by contacting the nodes whose PeerId is closest to the value.

Cool talk on Rust libp2p...
[link](https://github.com/tomaka/2018-rustrush-demo)

- It uses mDNS(multicast DNS) to discover nodes on a local network (also has a bootsrap node in case the Wifi doesnt allow mDNSx)
- It maintains a connection to every node it discovers.
- Broadcasts messages to all nodes it is connected to.

- uses multi-addressess

Connecting two nodes on a network... - they open a connection using a transport(TCP/IP, Unix Domain Sockets...) - On top of this connection they agree to an encryption protocol(secio for now 'tls' ? in the future) and perform a security handshake. - On top of the encryption protocol they agree to a Multiplexing protocol(yamux). - each High level request ( DHT, pub-sub message..) opens a new 'substream'.

- aside...
  - a blockchain network are good a talking to itself(same chain), but struggles to communicate with other networks. They can't scale...handle a lot of traffic without getting clogged up.
  - other than Bitcoin and Ethereum...security is very poor!
- blockchains are good at communicating with the data that is stored on them as long as everyone uses the same blockchain.
  For example....sending a message between Bitcoin and Tezos and getting it back is very challengin without an 'intermediary'

the code and value generated by the developers...plus the utility of the tech is bought and sold on coinbase exchange. Is it a currentcy or simply a stake in an idea? It seems like it's alalogous to the stock market in that you can take ownership of a company...where as here...we take ownership in the tech.

bitcoin is a **single blockchain**....and it does what it does very well...except talk to other blockchains or networks?? right? ..ok . Polkadot tries to solve this issue along with the others. that this space is encountering at the moment.

- can we think of a blockchain as a network of **'nodes'** that itself is a node? Seems like we have a network of so called 'Blockchain Types'...that need interoperability. This is where Polkadot comes in.

- Kusama ...is the same codebase as Polkadot, but is used for two things.

  1.

- Substrate is used to build custom block chains. A lot of the time comsuming boiler plate needed for a block chain can be implmented through Substrate (it's a framework built with Rust).
  - substrate.io is a site with tutorials that Parity has made for developers.

TPS....Transactions Per Second...

- Bitcoin: 7
- Ethereum: 15-20
- Visa: 65,000 tps Capacity (2018)
  but only saw 1,736 actual transactions per second in 2020
- Polkadot: 166,000 capacity...goal is 1M tps.

### World built on Polkadot.

    - Enterprise
        - Finance
        - SupplyChain
        - Data storage
        - Healthcare
    - Consumer
        - Social networking
        - Personal Finance
        - Gaming
        - Real estate
    - Govt
        - Land titles
        - identity managment
        - University certificate
        - Law

---

### libp2p

- Modled around 'Process addressing'
  - Find, connect and authenticate **processes**.
  - 1st class project based on IPFS(inter-planetary file system)
    - IPFS: uses a 'Content Addressing' model...find, fetch and authenticate **content**.
- Built from many many modular peices...

  - Transports
  - Content Routing
  - Stream Multiplexers
  - Record Stores
  - Crypto Channels
  - Peer discovery
  - many more....

- RFC 1958
- RFC 3439

---

- basic link between two nodes..

  - node A listening for TCP connections
  - node B knows the port that A is listening on...
  - B opens a connection with A and does a TLS-like handshake...
  - A and B exhange their public keys...prove that they own the corresponding private key...perform a **diffie-hellman**...???? all communication after is encrypted.
  - if B knew the PeerId of A ahead of time he could be sure it is authentic.
  - On top of this Multiplexing protocol is applied.

- Libp2p is more gereic than TCP...use 'Transports'.
  - it's agnostic over whether A and B used TCP...could of used UDP or QUIC or even BlueTooth(rust-libp2p-bluetooth).
  -

#### Multiplexing

- As a 'Transport' is created...
- libp2p is not unique in implementing this. Network connections are limited (the underlying medium) so multiplexing allows many streams (logical) to all use the same transport medium.
- TCP/IP stack multiplexes many TCP streams over an underlying network connection, using unique port numbers to distinguish streams. libp2p’s stream multiplexer sits “above” the transport stack and allows many streams to flow over a single TCP port or other raw transport connection.
- libp2p’s multiplexing happens at the “application layer”, meaning it’s **not provided by the operating system’s** network stack.

#### Switch/Swarm

- state about known peers and existing connections are stored in a component known as the switch (or “swarm”, depending on the implementation).
